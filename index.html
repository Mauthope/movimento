<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planejamento Logístico - Rebocador</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f4f4f9;
            color: #333;
        }
        h1, h2 {
            text-align: center;
            color: #4CAF50;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .section {
            background: #fff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            flex: 1;
            min-width: 300px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            text-align: center;
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            background: #4CAF50;
            color: white;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .btn-group {
            display: flex;
            justify-content: space-around;
        }
        .red {
            background-color: red !important;
        }
        .green {
            background-color: green !important;
        }
    </style>
</head>
<body>
    <h1>Planejamento Logístico do Rebocador</h1>
    <div class="container">
        <!-- Entrada de Dados -->
        <div class="section">
            <h2>Configuração dos Setores</h2>
            <h3>Rebocador</h3>
            <label for="cycle-time">Tempo de ciclo (min):</label>
            <input type="number" id="cycle-time" value="15"><br><br>
            <label for="rebocador-capacity">Capacidade (bobinas):</label>
            <input type="number" id="rebocador-capacity" value="6"><br><br>

            <h3>Impressoras (3)</h3>
            <label for="imp1">Máquina 1:</label>
            <input type="number" id="imp1" value="250"><br><br>
            <label for="imp2">Máquina 2:</label>
            <input type="number" id="imp2" value="250"><br><br>
            <label for="imp3">Máquina 3:</label>
            <input type="number" id="imp3" value="250"><br><br>

            <h3>Laminadoras (4)</h3>
            <label for="lam1">Máquina 1:</label>
            <input type="number" id="lam1" value="250"><br><br>
            <label for="lam2">Máquina 2:</label>
            <input type="number" id="lam2" value="250"><br><br>
            <label for="lam3">Máquina 3:</label>
            <input type="number" id="lam3" value="250"><br><br>
            <label for="lam4">Máquina 4:</label>
            <input type="number" id="lam4" value="250"><br><br>

            <button onclick="simulate()">Simular</button>
        </div>

        <!-- Resultado -->
        <div class="section">
            <h2>Resultados</h2>
            <div id="results">
                <p>Preencha os campos e clique em "Simular".</p>
            </div>
        </div>
    </div>

    <script>
        let activeCronometer = null;
        let cronometroInterval = null;

        function simulate() {
            // Dados de entrada
            const cycleTime = parseFloat(document.getElementById('cycle-time').value);
            const rebocadorCapacity = parseFloat(document.getElementById('rebocador-capacity').value);
            
            // Dados das máquinas
            const imp1 = parseFloat(document.getElementById('imp1').value);
            const imp2 = parseFloat(document.getElementById('imp2').value);
            const imp3 = parseFloat(document.getElementById('imp3').value);

            const lam1 = parseFloat(document.getElementById('lam1').value);
            const lam2 = parseFloat(document.getElementById('lam2').value);
            const lam3 = parseFloat(document.getElementById('lam3').value);
            const lam4 = parseFloat(document.getElementById('lam4').value);

            // Lógica de planejamento
            let viagens = [];
            let totalImp = 0, totalLam = 0;

            // Somando as bobinas de cada setor
            for (let i = 0; i < 10; i++) { // Exemplo de 10 viagens
                let viagem = { 
                    imp: imp1 + imp2 + imp3, 
                    lam: lam1 + lam2 + lam3 + lam4 
                };
                viagens.push(viagem);
            }

            // Renderização dos resultados
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <table>
                    <tr>
                        <th>Viagem</th>
                        <th>Impressão (Máquinas)</th>
                        <th>Laminação (Máquinas)</th>
                        <th>Atendimento</th>
                    </tr>
                    ${viagens.map((viagem, index) => `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${viagem.imp.toFixed(2)}</td>
                            <td>${viagem.lam.toFixed(2)}</td>
                            <td><button class="attend-btn" onclick="toggleCronometro(${index}, ${cycleTime}, this)">Atender</button></td>
                        </tr>
                    `).join('')}
                </table>
            `;
        }

        function toggleCronometro(index, cycleTime, button) {
            const viagemRow = button.closest('tr');
            const atendimentoCell = viagemRow.querySelector('td:last-child');
            let cronometroValue = viagemRow.querySelector('td:last-child');

            if (activeCronometer === index) {
                clearInterval(cronometroInterval);
                const totalTime = parseInt(cronometroValue.textContent); // Obtém o tempo registrado
                // Registra o tempo final
                cronometroValue.textContent = totalTime; 
                // Verifica a cor do botão
                if (totalTime > cycleTime) {
                    button.classList.add('red');
                    button.classList.remove('green');
                } else {
                    button.classList.add('green');
                    button.classList.remove('red');
                }
                activeCronometer = null;
                button.textContent = 'Atender';
            } else {
                // Se outro cronômetro estiver ativo, finaliza e registra o tempo
                if (activeCronometer !== null) {
                    const prevButton = document.querySelectorAll('table tr')[activeCronometer + 1].querySelector('button');
                    clearInterval(cronometroInterval);
                    prevButton.textContent = 'Atender';
                    prevButton.classList.remove('red');
                    prevButton.classList.remove('green');
                }

                activeCronometer = index;
                let startTime = Date.now(); // Guarda o momento de início

                button.textContent = 'Finalizar Atendimento';

                // Inicia o cronômetro
                cronometroInterval = setInterval(() => {
                    let elapsedTime = Math.floor((Date.now() - startTime) / 1000); // Tempo em segundos
                    atendimentoCell.textContent = elapsedTime;
                }, 1000);
            }
        }
    </script>
</body>
</html>
