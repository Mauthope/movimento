<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Atendimento</title>
    <style>
        .container {
            margin: 20px;
        }

        .atendimento-row {
            margin-bottom: 10px;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        .button-group button {
            padding: 10px;
        }

        .button-group button.green {
            background-color: green;
            color: white;
        }

        .button-group button.red {
            background-color: red;
            color: white;
        }

        .button-group button.blue {
            background-color: blue;
            color: white;
        }

        .button-group button.gray {
            background-color: gray;
            color: white;
        }

        .cronometro {
            margin-left: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="atendimentos">
            <!-- As máquinas serão adicionadas dinamicamente aqui -->
        </div>
        <button id="adicionar-maquina">Adicionar Máquina</button>
    </div>

    <script>
        const maquinas = [];
        let activeCronometer = null;
        let cronometroInterval = null;

        const adicionarMaquinaBtn = document.getElementById('adicionar-maquina');
        const atendimentosContainer = document.getElementById('atendimentos');

        adicionarMaquinaBtn.addEventListener('click', adicionarMaquina);

        function adicionarMaquina() {
            const maquinaIndex = maquinas.length;
            const maquina = {
                nome: `Máquina ${maquinaIndex + 1}`,
                atendimentoStatus: 'inativo', // pode ser 'inativo', 'em atendimento', 'finalizado'
                cronometroStartTime: null,
                atendimentoTime: 0
            };

            maquinas.push(maquina);

            const row = document.createElement('div');
            row.classList.add('atendimento-row');
            row.innerHTML = `
                <strong>${maquina.nome}</strong>
                <div class="button-group">
                    <button class="atendimento-btn green" onclick="atender(${maquinaIndex})">Atender</button>
                    <button class="parar-btn gray" onclick="pararAtendimento(${maquinaIndex})" disabled>Parar</button>
                </div>
                <div class="cronometro"></div>
            `;

            atendimentosContainer.appendChild(row);
        }

        function atender(index) {
            const maquina = maquinas[index];
            const atendimentoRow = atendimentosContainer.children[index];
            const atendimentoBtn = atendimentoRow.querySelector('.atendimento-btn');
            const pararBtn = atendimentoRow.querySelector('.parar-btn');
            const cronometroDiv = atendimentoRow.querySelector('.cronometro');

            if (maquina.atendimentoStatus === 'inativo') {
                // Inicia o atendimento
                maquina.atendimentoStatus = 'em atendimento';
                atendimentoBtn.classList.remove('green');
                atendimentoBtn.classList.add('red');
                atendimentoBtn.textContent = 'Em Atendimento';
                pararBtn.disabled = false;
                pararBtn.classList.remove('gray');
                pararBtn.classList.add('blue');

                maquina.cronometroStartTime = Date.now();
                maquina.atendimentoTime = 0;

                // Atualiza o cronômetro
                cronometroInterval = setInterval(() => {
                    const elapsedTime = Date.now() - maquina.cronometroStartTime;
                    maquina.atendimentoTime = elapsedTime / 60000;
                    cronometroDiv.textContent = `${maquina.atendimentoTime.toFixed(2)} min`;
                }, 1000);
            }
        }

        function pararAtendimento(index) {
            const maquina = maquinas[index];
            const atendimentoRow = atendimentosContainer.children[index];
            const atendimentoBtn = atendimentoRow.querySelector('.atendimento-btn');
            const pararBtn = atendimentoRow.querySelector('.parar-btn');
            const cronometroDiv = atendimentoRow.querySelector('.cronometro');

            // Finaliza o atendimento
            maquina.atendimentoStatus = 'finalizado';
            clearInterval(cronometroInterval);
            cronometroDiv.textContent += ` (Finalizado)`;
            
            atendimentoBtn.classList.remove('red');
            atendimentoBtn.classList.add('green');
            atendimentoBtn.textContent = 'Atendido';

            pararBtn.classList.remove('blue');
            pararBtn.classList.add('green');
            pararBtn.textContent = 'Finalizado';
            pararBtn.disabled = true;
        }
    </script>
</body>
</html>
