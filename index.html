<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planejamento Logístico - Rebocador</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f4f4f9;
            color: #333;
        }
        h1, h2 {
            text-align: center;
            color: #4CAF50;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .section {
            background: #fff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            flex: 1;
            min-width: 300px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            text-align: center;
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            background: #4CAF50;
            color: white;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .btn-group {
            display: flex;
            justify-content: space-around;
        }
        .red {
            background-color: red !important;
        }
        .green {
            background-color: green !important;
        }
    </style>
</head>
<body>
    <h1>Planejamento Logístico do Rebocador</h1>
    <div class="container">
        <!-- Entrada de Dados -->
        <div class="section">
            <h2>Configuração dos Setores</h2>
            <h3>Rebocador</h3>
            <label for="cycle-time">Tempo de ciclo (min):</label>
            <input type="number" id="cycle-time" value="15"><br><br>
            <label for="rebocador-capacity">Capacidade (bobinas):</label>
            <input type="number" id="rebocador-capacity" value="6"><br><br>

            <h3>Setor Impressão</h3>
            <label for="imp1">Impressora 1 (nº de bobinas por hora):</label>
            <input type="number" id="imp1" value="1"><br><br>
            <label for="imp2">Impressora 2 (nº de bobinas por hora):</label>
            <input type="number" id="imp2" value="1"><br><br>
            <label for="imp3">Impressora 3 (nº de bobinas por hora):</label>
            <input type="number" id="imp3" value="1"><br><br>

            <h3>Setor Laminação</h3>
            <label for="lam1">Laminadora 1 (nº de bobinas por hora):</label>
            <input type="number" id="lam1" value="1"><br><br>
            <label for="lam2">Laminadora 2 (nº de bobinas por hora):</label>
            <input type="number" id="lam2" value="1"><br><br>
            <label for="lam3">Laminadora 3 (nº de bobinas por hora):</label>
            <input type="number" id="lam3" value="1"><br><br>
            <label for="lam4">Laminadora 4 (nº de bobinas por hora):</label>
            <input type="number" id="lam4" value="1"><br><br>

            <button onclick="simulate()">Simular</button>
        </div>

        <!-- Resultado -->
        <div class="section">
            <h2>Resultados</h2>
            <div id="results">
                <p>Preencha os campos e clique em "Simular".</p>
            </div>
        </div>
    </div>

    <script>
        let activeCronometer = null;
        let cronometroInterval = null;

        function simulate() {
            // Dados de entrada
            const cycleTime = parseFloat(document.getElementById('cycle-time').value);
            const rebocadorCapacity = parseFloat(document.getElementById('rebocador-capacity').value);

            // Setores: Impressão e Laminação
            const imp1 = parseFloat(document.getElementById('imp1').value);
            const imp2 = parseFloat(document.getElementById('imp2').value);
            const imp3 = parseFloat(document.getElementById('imp3').value);
            const lam1 = parseFloat(document.getElementById('lam1').value);
            const lam2 = parseFloat(document.getElementById('lam2').value);
            const lam3 = parseFloat(document.getElementById('lam3').value);
            const lam4 = parseFloat(document.getElementById('lam4').value);

            // Lógica de planejamento para impressão e laminação
            let viagens = [];
            let totalImp = imp1 + imp2 + imp3;
            let totalLam = lam1 + lam2 + lam3 + lam4;
            let totalCut1 = 0, totalCut2 = 0;

            for (let i = 0; i < 10; i++) { // Exemplo de 10 viagens
                let viagem = { imp: Math.random() * totalImp, lam: Math.random() * totalLam, cut1: Math.random() * 10, cut2: Math.random() * 10, atendimento: 0 };
                viagens.push(viagem);
            }

            // Renderização dos resultados
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <table>
                    <tr>
                        <th>Viagem</th>
                        <th>Impressora 1</th>
                        <th>Impressora 2</th>
                        <th>Impressora 3</th>
                        <th>Laminadora 1</th>
                        <th>Laminadora 2</th>
                        <th>Laminadora 3</th>
                        <th>Laminadora 4</th>
                        <th>Corte 1</th>
                        <th>Corte 2</th>
                        <th>Atendimento</th>
                    </tr>
                    ${viagens.map((viagem, index) => `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${viagem.imp.toFixed(2)}</td>
                            <td>${viagem.imp.toFixed(2)}</td>
                            <td>${viagem.imp.toFixed(2)}</td>
                            <td>${viagem.lam.toFixed(2)}</td>
                            <td>${viagem.lam.toFixed(2)}</td>
                            <td>${viagem.lam.toFixed(2)}</td>
                            <td>${viagem.lam.toFixed(2)}</td>
                            <td>${viagem.cut1.toFixed(2)}</td>
                            <td>${viagem.cut2.toFixed(2)}</td>
                            <td><button class="attend-btn" onclick="toggleCronometro(${index}, ${cycleTime}, this)">Atender</button></td>
                        </tr>
                    `).join('')}
                </table>
            `;
        }

        function toggleCronometro(index, cycleTime, button) {
            const viagemRow = button.closest('tr');
            const atendimentoCell = viagemRow.querySelector('td:last-child');
            let cronometroValue = viagemRow.querySelector('td:last-child');

            if (activeCronometer === index) {
                clearInterval(cronometroInterval);
                const totalTime = parseInt(cronometroValue.textContent); // Obtém o tempo registrado
                // Registra o tempo final
                cronometroValue.textContent = totalTime; 
                // Verifica a cor do botão
                if (totalTime > cycleTime) {
                    button.classList.add('red');
                    button.classList.remove('green');
                } else {
                    button.classList.add('green');
                    button.classList.remove('red');
                }
                activeCronometer = null;
                button.textContent = 'Atender';
            } else {
                // Se outro cronômetro estiver ativo, finaliza e registra o tempo
                if (activeCronometer !== null) {
                    const prevButton = document.querySelectorAll('table tr')[activeCronometer + 1].querySelector('button');
                    clearInterval(cronometroInterval);
                    prevButton.classList.add('red');
                    prevButton.classList.remove('green');
                    prevButton.textContent = 'Atender';
                }

                // Inicia o cronômetro
                activeCronometer = index;
                let seconds = 0;
                cronometroInterval = setInterval(function () {
                    cronometroValue.textContent = seconds;
                    seconds += 1;
                }, 1000);

                button.classList.add('green');
                button.classList.remove('red');
                button.textContent = 'Parar';
            }
        }
    </script>
</body>
</html>
