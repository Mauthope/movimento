<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planejamento Logístico - Rebocador</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f4f4f9;
            color: #333;
        }
        h1, h2 {
            text-align: center;
            color: #4CAF50;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .section {
            background: #fff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            flex: 1;
            min-width: 300px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            text-align: center;
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            background: #4CAF50;
            color: white;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .btn-group {
            display: flex;
            justify-content: space-around;
        }
        .red {
            background-color: red !important;
        }
        .green {
            background-color: green !important;
        }
    </style>
</head>
<body>
    <h1>Planejamento Logístico do Rebocador</h1>
    <div class="container">
        <!-- Entrada de Dados -->
        <div class="section">
            <h2>Configuração dos Setores</h2>
            <h3>Rebocador</h3>
            <label for="cycle-time">Tempo de ciclo (min):</label>
            <input type="number" id="cycle-time" value="15"><br><br>
            <label for="rebocador-capacity">Capacidade (bobinas):</label>
            <input type="number" id="rebocador-capacity" value="6"><br><br>

            <button onclick="simulate()">Simular</button>
        </div>

        <!-- Resultado -->
        <div class="section">
            <h2>Resultados</h2>
            <div id="results">
                <p>Preencha os campos e clique em "Simular".</p>
            </div>
        </div>
    </div>

    <script>
        let activeCronometer = null;
        let cronometroInterval = null;

        function simulate() {
            // Dados de entrada
            const cycleTime = parseFloat(document.getElementById('cycle-time').value);
            const rebocadorCapacity = parseFloat(document.getElementById('rebocador-capacity').value);

            // Lógica de planejamento
            let viagens = [];
            let totalImp = 0, totalLam = 0, totalCut1 = 0, totalCut2 = 0;

            // Criar dados fictícios para ilustrar
            for (let i = 0; i < 10; i++) { // Exemplo de 10 viagens
                let viagem = {
                    imp: [Math.random() * 10, Math.random() * 10, Math.random() * 10], // 3 impressoras
                    lam: [Math.random() * 10, Math.random() * 10, Math.random() * 10, Math.random() * 10], // 4 laminadoras
                    cut1: [Math.random() * 10, Math.random() * 10], // 2 cortadores no corte 1
                    cut2: [Math.random() * 10, Math.random() * 10], // 2 cortadores no corte 2
                    atendimento: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] // Inicializa atendimento para cada máquina
                };
                viagens.push(viagem);
            }

            // Renderização dos resultados
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <table>
                    <tr>
                        <th>Viagem</th>
                        <th>Impressora 1</th>
                        <th>Impressora 2</th>
                        <th>Impressora 3</th>
                        <th>Laminação 1</th>
                        <th>Laminação 2</th>
                        <th>Laminação 3</th>
                        <th>Laminação 4</th>
                        <th>Corte 1</th>
                        <th>Corte 2</th>
                        <th>Atendimento</th>
                    </tr>
                    ${viagens.map((viagem, index) => `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${viagem.imp[0].toFixed(2)}</td>
                            <td>${viagem.imp[1].toFixed(2)}</td>
                            <td>${viagem.imp[2].toFixed(2)}</td>
                            <td>${viagem.lam[0].toFixed(2)}</td>
                            <td>${viagem.lam[1].toFixed(2)}</td>
                            <td>${viagem.lam[2].toFixed(2)}</td>
                            <td>${viagem.lam[3].toFixed(2)}</td>
                            <td>${viagem.cut1[0].toFixed(2)}</td>
                            <td>${viagem.cut2[0].toFixed(2)}</td>
                            <td>
                                <button class="attend-btn" onclick="toggleCronometro(${index}, 0, 0, ${cycleTime}, this)">Atender</button>
                            </td>
                        </tr>
                    `).join('')}
                </table>
            `;
        }

        function toggleCronometro(index, machineIndex, machineType, cycleTime, button) {
            const viagemRow = button.closest('tr');
            let atendimentoCell = viagemRow.querySelector('td:last-child');
            let cronometroValue = atendimentoCell;

            if (activeCronometer === index) {
                clearInterval(cronometroInterval);
                const totalTime = parseInt(cronometroValue.textContent);
                cronometroValue.textContent = totalTime; 

                if (totalTime > cycleTime) {
                    button.classList.add('red');
                    button.classList.remove('green');
                } else {
                    button.classList.add('green');
                    button.classList.remove('red');
                }

                activeCronometer = null;
                button.textContent = 'Atender';
            } else {
                if (activeCronometer !== null) {
                    const prevButton = document.querySelectorAll('table tr')[activeCronometer + 1].querySelector('button');
                    clearInterval(cronometroInterval);
                    prevButton.textContent = 'Atender';
                    prevButton.classList.remove('red');
                    prevButton.classList.remove('green');
                }

                activeCronometer = index;
                let startTime = Date.now(); // Guarda o momento de início

                button.textContent = 'Finalizar Atendimento';

                cronometroInterval = setInterval(() => {
                    let elapsedTime = Math.floor((Date.now() - startTime) / 1000); // Tempo em segundos
                    atendimentoCell.textContent = elapsedTime;
                }, 1000);
            }
        }
    </script>
</body>
</html>
